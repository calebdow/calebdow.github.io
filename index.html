<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="css/style.css" type="text/css"/>
    <img src="https://www.strausscenter.org/images/footer_logo/StraussLogo.gif" id="strauss">
    <h1> CEPSA Coding Page </h1>
    <title>Read File (via User Input selection)</title>
        <ul id=list>
          <li><input type='button' onclick= 'PilotWords()' value='1'></li>
          <li><input type='button' onclick= 'FeasibilityWords()' value='2'></li>
          <li><input type='button' onclick= 'AddFinWords()' value='3'></li>
          <li><input type='button' onclick= 'EducateWords()' value='4'></li>
          <li><input type='button' onclick= 'CapBuildWords()' value='5'></li>
          <li><input type='button' onclick= 'findSentence()' value='6'></li>
          <li><input type='button' onclick= 'changeText()' value='7'></li>
          <li><input type='button' onclick= 'windowFind()' value='8'></li>
          <li><input type='button' onclick= 'findSentence()' value='9'></li>
          <li><input type='button' onclick= 'changeText()' value='10'></li>
          <li><input type='button' onclick= 'windowFind()' value='11'></li>
          <li><input type='button' onclick= 'findSentence()' value='12'></li>
          <li><input type='button' onclick= 'changeText()' value='13'></li>
          <li><input type='button' onclick= 'windowFind()' value='14'></li>
          <li><input type='button' onclick= 'findSentence()' value='15'></li>
          <li><input type='button' onclick= 'changeText()' value='16'> </li>
        </ul>
        <ul id='listwo'>
          <li><input type='button' onclick= 'bangLoc()' value='Bangladesh Locations'></li>
          <li><input type='button' onclick= 'bangLoc()' value='Vietnam Locations'></li>
          <li><input type='button' onclick= 'bangLoc()' value='Laos Locations'></li>

        </ul>
        
    <script type="text/javascript">
    alert ("Upload your text file on the page and then click through the buttons below to search your text for all of the CEPSA key words")
   
    var reader; //GLOBAL File Reader object for demo purpose only

    /**
     * Check for the various File API support.
     */
    function checkFileAPI() {
        if (window.File && window.FileReader && window.FileList && window.Blob) {
            reader = new FileReader();
            return true; 
        } else {
            alert('The File APIs are not fully supported by your browser. Fallback required.');
            return false;
        }
    }

    /**
     * read text input
     */
    function readText(filePath) {
        var output = ""; //placeholder for text output
        if(filePath.files && filePath.files[0]) {           
            reader.onload = function (e) {
                output = e.target.result;
                displayContents(output);
            };//end onload()
            reader.readAsText(filePath.files[0]);
        }//end if html5 filelist support
        else if(ActiveXObject && filePath) { //fallback to IE 6-8 support via ActiveX
            try {
                reader = new ActiveXObject("Scripting.FileSystemObject");
                var file = reader.OpenTextFile(filePath, 1); //ActiveX File Object
                output = file.ReadAll(); //text contents of file
                file.Close(); //close file "input stream"
                displayContents(output);
            } catch (e) {
                if (e.number == -2146827859) {
                    alert('Unable to access local files due to browser security settings. ' + 
                     'To overcome this, go to Tools->Internet Options->Security->Custom Level. ' + 
                     'Find the setting for "Initialize and script ActiveX controls not marked as safe" and change it to "Enable" or "Prompt"'); 
                }
            }       
        }
        else { //this is where you could fallback to Java Applet, Flash or similar
            return false;
        }       
        return true;
    }   

    /**
     * display content using a basic HTML replacement
     */
    function displayContents(txt) {
        var el = document.getElementById('main'); 
        el.innerHTML = txt; //display output in DOM
    }   

    
    function PilotWords() {
       var text = document.getElementById('main').innerHTML
       var pilotProjectSent = /[A-Z][^\\.;]*(pilot)[^\\.;]*/gi
       var count1 = (text.match(pilotProjectSent) || [])
            for (i=0; i< count1.length; i++) {
                alert (count1[i])}
     };
    function FeasibilityWords() {
       var text = document.getElementById('main').innerHTML
       var FeasibleSent = /[A-Z][^\\.;]*(feasib)[^\\.;]*|[A-Z][^\\.;]*(plann)[^\\.;]*/gi
       var count2 = (text.match(FeasibleSent) || [])
            for (i=0; i< count2.length; i++) {
                alert (count2[i])}
     };
    
    function AddFinWords() {
       var text = document.getElementById('main').innerHTML
       var AddFinSent = /[A-Z][^\\.;]*(?:financ(e|ing)?\W+(?:\w+\W+){0,10}?additional|additional\W+(?:\w+\W+){0,10}?financ(e|ing)?)[^\\.;]*/gi
       var count3 = (text.match(AddFinSent) || [])
            for (i=0; i< count3.length; i++) {
                alert (count3[i])}
     };

     function EducateWords() {
       var text = document.getElementById('main').innerHTML
       var EducSent = /[A-Z][^\\.;]*(educat)[^\\.;]*|[A-Z][^\\.;]*(train)[^\\.;]*/gi
       var count4 = (text.match(EducSent) || [])
            for (i=0; i< count4.length; i++) {
                alert (count4[i])}
     };

     function CapBuildWords() {
       var text = document.getElementById('main').innerHTML
       var CapBuildSent = /[A-Z][^\\.;]*(?:capacity?\W+(?:\w+\W+){0,10}?buil|buil\W+(?:\w+\W+){0,10}?capacity?)[^\\.;]*/gi
       var count5 = (text.match(CapBuildSent) || [])
            for (i=0; i< count5.length; i++) {
                alert (count5[i])}
     };

     function CapBuildWords() {
       var text = document.getElementById('main').innerHTML
       var CapBuildSent = /[A-Z][^\\.;]*(?:capacity?\W+(?:\w+\W+){0,10}?buil|buil\W+(?:\w+\W+){0,10}?capacity?)[^\\.;]*/gi
       var count5 = (text.match(CapBuildSent) || [])
            for (i=0; i< count5.length; i++) {
                alert (count5[i])}
     };
     /*function TechWords() {
       alert ("this is as far as I have gotten with the sentence search function for documents. Also the technology keyword returns a ridiculous amount of sentences. We may need to rethink this one as well as the one for education and training")
     };*/

        function windowFind(){
        var pilotWords = ["pilot","project"];
        for (var i = 0; i < pilotWords.length; i++) {
            ("Find ->  are = " + window.find(pilotWords[i]))}
      }

    function CountWordsPlan() {
        //alert("We will start by highlighting all the required search terms then we will being our search by looking for the instances of the word 'program'")
        var text = document.getElementById('main').innerHTML;
            var count = (text.match(/plan/gi) || []).length;
                alert ("the word plan occured " + count + " times.")
     };
    function windowFindPlan() { 
        ("Find ->  are = " + window.find("plan"))
        ("Find ->  are = " + window.find("feasib"))}

    function changeText(){
            var pilotProject = (/piloted|pilot|piloting|project/gi)
            var count = (text.match(pilotProject) || []).length;
                alert ("The word pilot occured " + count + " times. And they are highlighted below ")
            var feasible = (/feasible|feasibility|planning/gi)
            var count = (text.match(feasible) || []).length;
                alert ("The word feasible occured " + count + " times.")
                    
            var count = (text.match(/adapt/g) || []).length;
                alert ("The word adapt occured " + count + " times.")
            }

    function bangLoc(){
            alert ("location search feature coming soon")
    }
     

</script>
</head>
<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>
<body onload="checkFileAPI();">
    <div id="container">    
        <input type="file" onchange='readText(this)' />
        <br/>
        <hr/>   
        <h3>Here is your file to code:</h3>
        <div id="main">
            ...
        </div>
    </div>
</body>      
<h3> <a href = "http://pdftotext.com/"target="_blank"> Follow this link to convert your PDF file to text </a></h3>
<h3> <a href = "https://www.strausscenter.org/cepsa/about.html"target="_blank"> Click here for more information on our methodology </a></h3>
<h3> <a href = "https://drive.google.com/folderview?id=0B_KklJeZo8MMNS1OR2QxY3N1TGc&usp=sharing"target="_blank"> Download sample project documents to test through this link</a></h3>
</html>
